# [Smuggled Away]

**Category:** [Network Forensics/Data Exfiltration] | **Difficulty:** [Hard] | **Points:** [500]

---

## Challenge

Aye, ye be a smart one! Looks like we found where the stolen data is being smuggled out from... Since it looks like the pirates have already stolen some of our data, can we at least find out what they stole? If it's customer data, we may have an obligation to notify the affected parties…
Use your best skills to discover and what they took.

---

## Solution

I needed to extract encoded data from DNS requests and decode it through multiple layers of encoding/compression to reveal the exfiltrated information.

### Steps
1. Started by applying the same Wireshark filters from the previous challenge to isolate DNS requests from the exfiltrating machine (10.75.34.13). Used tshark to extract just the subdomain portions since the domain names seemed irrelevant - just needed the encoded data before the first dot
2. Looking at the extracted string, I noticed it only contained lowercase letters and numbers 2-7. This immediately made me think of Base32 since it normally uses A-Z and 2-7, but the lowercase threw me off initially. Realized the attacker probably modified standard Base32 to avoid detection
3. First tried Base32 with uppercase conversion in CyberChef, which gave me binary data but not readable text. Figured the data might be compressed to reduce size during exfiltration, so tried Gunzip next. Eureka! The combination of Base32 decode + Gunzip decompression revealed the plaintext with all the credit card details I needed!

---

## Notes
- Key technique: Multi-layer decoding (Base32 → Gzip decompression) of DNS-tunneled data
- What made this tricky: Had to recognize the modified Base32 alphabet and that data was compressed after encoding
- Time taken: 1 hour 30 minutes